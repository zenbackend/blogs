---
import Logo from "@/components/Logo.astro";
import menu from "@/config/menu.json";
import { IoSearch } from "react-icons/io5";

export interface ChildNavigationLink {
  name: string;
  url: string;
  hasChildren?: boolean;
  children?: ChildNavigationLink[];
}

const { main }: { main: NavigationLink[] } = menu;
---

<header class="bg-white text-gray-800 py-4 fixed top-0 w-full z-50 border-b border-gray-200">
  <nav class="container mx-auto flex items-center justify-between px-4">
    <!-- Logo -->
    <div class="flex items-center space-x-4">
      <Logo />
    </div>

    <!-- Desktop Menu -->
    <ul class="hidden md:flex items-center space-x-8">
      {main.map((menu) => (
        <li class="relative group">
          {menu.hasChildren ? (
            <>
              <span class="cursor-pointer inline-flex items-center hover:text-blue-600">
                {menu.name}
                <svg class="w-4 h-4 ml-1" fill="#007BFF" viewBox="0 0 20 20">
                  <path d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" />
                </svg>
              </span>
              <ul class="absolute left-0 mt-2 w-40 hidden group-hover:block bg-white text-gray-800 rounded-md shadow-lg border border-gray-200">
                {menu.children?.map((child) => (
                  <li>
                    <a href={child.url} class="block px-4 py-2 hover:bg-gray-100">
                      {child.name}
                    </a>
                  </li>
                ))}
              </ul>
            </>
          ) : (
            <a href={menu.url} class="hover:text-blue-600">
              {menu.name}
            </a>
          )}
        </li>
      ))}
    </ul>

    <!-- Search Icon -->
    <div class="hidden md:flex items-center space-x-4">
      <a href="/search" class="text-xl text-gray-800 hover:text-blue-600">
        <IoSearch />
      </a>
    </div>

    <!-- Mobile Toggle Button -->
    <div class="md:hidden">
      <button id="nav-toggle" class="focus:outline-none">
        <svg class="h-6 w-6 text-gray-800 transition-transform duration-200 ease-in-out transform hover:scale-110 hover:text-gray-600" fill="none" viewBox="0 0 24 24">
          <path class="stroke-current" stroke="currentColor" stroke-width="2" d="M4 6h16M4 12h16m-7 6h7"></path>
        </svg>
      </button>
    </div>
  </nav>

  <!-- Mobile Menu -->
  <div id="nav-menu" class="hidden flex-col space-y-4 px-4 py-6 bg-white text-gray-800 md:hidden rounded-lg shadow-lg transition-transform transform opacity-0 scale-95 duration-300 ease-in-out">
    <ul class="space-y-4">
      {main.map((menu) => (
        <li>
          {menu.hasChildren ? (
            <>
              <span class="cursor-pointer inline-flex items-center hover:text-blue-600">
                {menu.name}
                <svg class="w-4 h-4 ml-1" fill="#007BFF" viewBox="0 0 20 20">
                  <path d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" />
                </svg>
              </span>
              <ul class="pl-4 mt-2 space-y-2">
                {menu.children?.map((child) => (
                  <li>
                    <a href={child.url} class="block hover:text-blue-600">
                      {child.name}
                    </a>
                  </li>
                ))}
              </ul>
            </>
          ) : (
            <a href={menu.url} class="block hover:text-blue-600">
              {menu.name}
            </a>
          )}
        </li>
      ))}
    </ul>
    <div class="mt-4">
      <a href="/search" class="text-xl text-gray-800 hover:text-blue-600">
        <IoSearch />
      </a>
    </div>
  </div>

  <script>
    document.addEventListener("DOMContentLoaded", () => {
      const navToggle = document.getElementById("nav-toggle");
      const navMenu = document.getElementById("nav-menu");

      navToggle.addEventListener("click", () => {
        navMenu.classList.toggle("hidden");
        navMenu.classList.toggle("opacity-0");
        navMenu.classList.toggle("scale-95");
        navMenu.classList.toggle("scale-100");
        navMenu.classList.toggle("opacity-100");
      });
    });
  </script>
</header>
